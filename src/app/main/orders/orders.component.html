<div class="row fixed-row">
  <div class="col-sm-12">
    <div class="card rounded-0">
      <div class="card-body d-flex justify-content-between " style="padding-bottom: 10px;">
        <div>
          <div class="pb-2 path">
            orders >
          </div>
          <div class="d-flex justify-content-between">
            <div>
              <h2>Orders</h2>
            </div>
          </div>
        </div>
        <div class="progress_div" *ngIf="progresbarShow">
          <div class="p-2">
            <p style="margin-bottom: 3px;">Importing data</p>
            <div class="">
              <mat-progress-bar style="height: 30px;" mode="indeterminate"></mat-progress-bar>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row movable-content container-fluid">
  <div class="col-sm-12">
    <div class="card rounded-0">
      <div class="card-body " style="padding-bottom: 10px;">
        <div>
          <div class="d-flex justify-content-between moibleSpace">
            <div class="row moibleSpaceDropDown" style="display: flex;  justify-content: center">
              <div style="font-size: 12px" class="col pr-0">
                <mat-form-field subscriptSizing="dynamic" appearance="outline" style="border-style: none"
                  class="custom-mat-field foe">
                  <mat-label>search here</mat-label>
                  <input class="foe" matInput #input (keyup)="applyFilter($event)">
                  <img class="search-icon"
                    src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/Vector (2).png" src="" alt="">
                </mat-form-field>
              </div>
              <div class="col pr-0">
                <mat-form-field subscriptSizing="dynamic" appearance="outline" class="foe" style="width: 115px;">
                  <mat-label>Client</mat-label>
                  <mat-select [(ngModel)]="selectedClient" (ngModelChange)="onAlbumselected($event)">
                    <mat-option [value]="client" *ngFor="let client of ClientList">{{client}}</mat-option>
                  </mat-select>
                </mat-form-field>

              </div>
              <div class="col pr-0 ">
                <mat-form-field subscriptSizing="dynamic" appearance="outline" class="foe" style="width: 115px;">
                  <mat-label>Vendor</mat-label>
                  <mat-select [(ngModel)]='selectedVendor' (ngModelChange)="vendorselected($event)">
                    <mat-option [value]="vendor" *ngFor="let vendor of vendorList">{{vendor}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col pr-0">
                <mat-form-field subscriptSizing="dynamic" appearance="outline" class="foe" style="width: 135px;">
                  <mat-label>Published</mat-label>
                  <mat-select [(ngModel)]='selectedPublished' (ngModelChange)="publishselected($event)">
                    <mat-option [value]="true">Published</mat-option>
                    <mat-option [value]="false">UnPublished</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
            <div class="dropdown">
              <button class="btn btn-danger mobileMargin" #dropdown (click)="ExcelOpertions(); toggleDropdown()"
                style="cursor: default;">Excel Operations
                <img *ngIf="!victorImage" src="../../../assets/images/ArrowIcon2.png"
                  src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/ArrowIcon2.png" alt="">
                <img *ngIf="victorImage"
                  src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/downVictor.png" alt="">
              </button>
              <div class="dropdown-menu" [class.show]="isDropdownOpen">
                <p class="dropdown-item mb-0" (click)="exportToExcel()">Export to excel</p>
                <p class="dropdown-item mb-0" style="padding-left: 9px;padding-bottom: 0px;">
                  <label for="fileInput" class="custom-file-upload">
                    <i class="fas fa-cloud-upload-alt"></i> Import from excel
                  </label>
                  <input id="fileInput" type="file" (change)="onFileSelected($event)">
                </p>
                <p class="dropdown-item mb-0"><a style="font-weight: bold; text-decoration: underline; color: black;"
                    href="https://solizecorporateweb.s3.amazonaws.com/product_sample_data.xlsx" download>Click
                    here</a>
                  to download <br> sample import file</p>
              </div>
            </div>
          </div>
          <div class="d-flex mt-3  gap-2 mobileMargin">
            <div class="d-flex align-items-center">
              <h5 class="m-0">Unpublished ({{nonPublishedCount}})</h5>
            </div>
            <div class="">
              <button class="btn btn-publish" (click)="updatePublish()" style="cursor: default;     font-size: 15px;  position: relative;
              ">Publish <img src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/Frame 67617.jpg"
                  alt="" width="12px"></button>
            </div>
          </div>
        </div>
      </div>
      <div class="row container-fluid">
        <div class="col-sm-12  tab_align">
          <div class="card-body table-responsive">
            <table mat-table
              [dataSource]="dataSource.data.length > 0 && dataSource.filteredData.length > 0 ? dataSource : emptyData"
              class="mat-elevation-z8">
              <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                  <mat-checkbox (change)="$event ? masterToggle() : null"
                    [checked]="selection.hasValue() && isAllSelected()"
                    [indeterminate]="selection.hasValue() && !isAllSelected()">
                  </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                  <mat-checkbox (click)="$event.stopPropagation()" (change)="checkboxChange($event, row)"
                    [checked]="selection.isSelected(row) || row.published" [disabled]="row.published"
                    [ngClass]="{ 'disabled-button': row.published }">
                  </mat-checkbox>
                </td>
              </ng-container>
              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>S.No </th>
                <td mat-cell *matCellDef="let element let i = index">
                  {{ getSerialNumber(i) }} </td>
              </ng-container>
              <ng-container matColumnDef="Vendor">
                <th mat-header-cell *matHeaderCellDef> Vendor Name</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.vendorName}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="Product">
                <th mat-header-cell *matHeaderCellDef> Product Name</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.productName}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="HSMSACCode">
                <th mat-header-cell *matHeaderCellDef> HSM/SAC Code</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.sachsncode}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="Client">
                <th mat-header-cell *matHeaderCellDef> Client</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.clientName}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="DivisionName">
                <th mat-header-cell *matHeaderCellDef>Division Name</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.divisionName}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="LicenseType">
                <th mat-header-cell *matHeaderCellDef> License Type</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.licenseTypeName}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="Rate">
                <th mat-header-cell *matHeaderCellDef> Rate</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.amount}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.amount">
                </td>
              </ng-container>
              <ng-container matColumnDef="Quantity">
                <th mat-header-cell *matHeaderCellDef> Quantity</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.quantity}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.quantity">
                </td>
              </ng-container>
              <ng-container matColumnDef="PeriodStartDate">
                <th mat-header-cell *matHeaderCellDef> Period StartDate</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.effectiveDate}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.effectiveDate">
                </td>
              </ng-container>
              <ng-container matColumnDef="PeriodEndDate">
                <th mat-header-cell *matHeaderCellDef> Period EndDate</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.expiryDate}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.expiryDate">
                </td>
              </ng-container>
              <ng-container matColumnDef="InvoiceNo">
                <th mat-header-cell *matHeaderCellDef> Invoice No</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.invoiceNo}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.invoiceNo">
                </td>
              </ng-container>
              <ng-container matColumnDef="ServiceNo">
                <th mat-header-cell *matHeaderCellDef> Service No</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.serviceNumber}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.serviceNumber">
                </td>
              </ng-container>
              <ng-container matColumnDef="PurchaseOrderNo">
                <th mat-header-cell *matHeaderCellDef> Purchase OrderNo</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.purchaseOrderId}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.purchaseOrderId">
                </td>
              </ng-container>
              <ng-container matColumnDef="PurchaseOrderDate">
                <th mat-header-cell *matHeaderCellDef> Purchase OrderDate</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.purchaseOrderDate}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.purchaseOrderDate">
                </td>
              </ng-container>
              <ng-container matColumnDef="PaymentTerms">
                <th mat-header-cell *matHeaderCellDef> Payment Terms</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.paymentTerms}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.paymentTerms">
                </td>
              </ng-container>
              <ng-container matColumnDef="PaymentStatus">
                <th mat-header-cell *matHeaderCellDef> Payment Status</th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="!element.isEdit">{{element.paymentStatus}}</div>
                  <input *ngIf="element.isEdit" type="text" [(ngModel)]="element.paymentStatus">
                </td>
              </ng-container>
              <ng-container matColumnDef="RegionTerritory">
                <th mat-header-cell *matHeaderCellDef> Region Territory</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.territory}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="BillToAddress">
                <th mat-header-cell *matHeaderCellDef> Bill ToAddress</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.billingAddress}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="SupplyToAddress">
                <th mat-header-cell *matHeaderCellDef> Supply ToAddress</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{element.shippingAddress}}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="empty-row">
                <mat-cell *matCellDef="let element">
                  <p>NoDataFound</p>
                </mat-cell>
              </ng-container>
              <ng-container matColumnDef="Action">
                <th mat-header-cell *matHeaderCellDef class="custom-header">Action</th>
                <td mat-cell *matCellDef="let element">
                  <button [ngClass]="{ 'disabled-button': element.published }" [disabled]="element.published"
                    style="background: none; border: none;" *ngIf="!element.isEdit" (click)="editItem(element)">
                    <img src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/editIcon.png" alt="">
                  </button>
                  <button [disabled]="element.published" [ngClass]="{ 'disabled-button': element.published }"
                    *ngIf="!element.isEdit" style="margin-left: 11px;background: none; border: none;"
                    (click)="deleteItem(element)" data-toggle="modal" data-target="#exampleModalCenter">
                    <img src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/orderdelicon.png" alt="">
                  </button>
                  <div *ngIf="element.isEdit" class="d-flex ">
                    <button (click)="update(element)" style="background: none; border: none;">
                     <i class="fa fa-check"></i>
                    </button>
                    <button style="margin-left: 11px; background: none; border: none;" (click)="cancelEdit(element)">
                    <i class="fa fa-close"></i>
                    </button>
                  </div>
                </td>
              </ng-container>
              <tr style="background-color: #F3F4F5;" mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row
                *matRowDef="let row; columns: dataSource.data.length > 0 && dataSource.filteredData.length > 0 ? displayedColumns : ['empty-row']">
              </tr>
            </table>
          </div>
          <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons></mat-paginator>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">
          <img src="https://solizecorporateweb.s3.amazonaws.com/admin/asset/images/deleteIcon.png" width="20px" alt="">
          Delete
        </h5>
      </div>
      <div class="modal-footer">
        <div>
          <h6> Are you want to delete ?</h6>
        </div>
        <div>
          <button type="button" class="btn btn-primary" style="width: 150px;height: 40px;" data-dismiss="modal"
            (click)="deleteOrder()">Yes</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal"
            style="width: 150px;height: 40px; margin-left: 20px;">No</button>
        </div>
      </div>
    </div>
  </div>
</div>